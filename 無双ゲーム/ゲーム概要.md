# 無双ゲーム 設計ドキュメント

---

## 1. ゲームコンセプト

### 1.1 基本コンセプト
- **ジャンル**: 爽快アクション無双ゲーム
- **参考作品**: 戦国無双、海賊無双、真・三國無双
- **プラットフォーム**: Roblox

### 1.2 ゲームの魅力ポイント
1. **爽快感**: 大量の敵を一掃する気持ちよさ
2. **成長感**: キャラクターが強くなっていく実感
3. **収集要素**: キャラクター、武器、スキルの収集
4. **やりこみ**: 難易度別ステージ、ランキング

---

## 2. ゲームフロー（プレイヤー体験）

```
[タイトル画面]
    ↓
[ホーム画面] ←──────────────────┐
    │                          │
    ├→ ステージ選択 → バトル → リザルト
    ├→ キャラクター
    ├→ 武器/装備
    ├→ ガチャ（課金）
    ├→ ショップ
    └→ 設定
```

---

## 3. 基本構造

### 3.1 ゲームモード

| モード | 説明 |
|--------|------|
| **ストーリーモード** | メインシナリオを進める。章ごとに分かれる |
| **フリーモード** | クリア済みステージを自由にプレイ |
| **チャレンジモード** | 特殊条件で高スコアを狙う（タイムアタック等） |
| **レイドボス** | 期間限定の強敵を討伐（マルチ対応検討） |

### 3.2 バトルシステム

#### 基本アクション
| 操作 | アクション |
|------|-----------|
| 通常攻撃 | 連続タップでコンボ発動（最大8連撃） |
| 溜め攻撃 | 長押しで範囲攻撃 |
| スキル1 | クールダウン10秒の必殺技 |
| スキル2 | クールダウン20秒の必殺技 |
| 無双奥義 | ゲージMAXで発動、画面全体に大ダメージ |
| 回避 | ダブルタップで緊急回避（無敵フレームあり） |

#### 無双ゲージ
- 敵を攻撃/撃破でゲージ上昇
- MAXになると無双奥義が使用可能
- 発動で画面全体に大ダメージ＋無敵時間

#### 武器システム
| 要素 | 説明 |
|------|------|
| キャラ固有武器 | 各キャラに専用武器がある |
| 装備武器 | ガチャ/ドロップで入手した武器を装備可能 |
| 武器効果 | 攻撃力倍率、特殊効果（火属性付与等） |

#### 敵の種類
| 種類 | 特徴 |
|------|------|
| **雑魚敵** | 大量出現、1〜2撃で倒せる |
| **中型敵** | ある程度HP、特定の攻撃パターン |
| **精鋭敵** | 高HP、ガードあり、倒すとドロップ |
| **ボス** | ステージ最後に出現、複数フェーズ |

#### コンボシステム
- 連続で敵を倒すとコンボカウンター上昇
- コンボ数に応じて経験値・ドロップ率ボーナス
- 一定時間攻撃しないとリセット

#### バトルシステム実装優先度

| 順番 | 内容 | フェーズ |
|------|------|----------|
| 1 | 通常攻撃（素手） | MVP |
| 2 | スキル1, 2 | MVP |
| 3 | 無双奥義 | MVP |
| 4 | 溜め攻撃 | 後で追加 |
| 5 | 武器システム | 後で追加 |
| 6 | キャラ固有武器 | 後で追加 |
| 7 | 回避アクション | 後で追加 |

---

## 4. ステージ設計

### 4.1 ワールド構成（案）

| ワールド | テーマ | ステージ数 |
|----------|--------|-----------|
| 第1章 | 草原・平原 | 5ステージ |
| 第2章 | 城下町・城 | 5ステージ |
| 第3章 | 山岳・洞窟 | 5ステージ |
| 第4章 | 海岸・港 | 5ステージ |
| 第5章 | 魔境・ラスボス | 5ステージ |
| イベント | 期間限定 | 随時追加 |

### 4.2 ステージ構造（1ステージの流れ）

```
[ステージ開始]
    ↓
[ウェーブ1〜4] 雑魚100体を撃破
    ↓
[ボス出現] 101体目としてボス登場
    ↓
[ボス撃破]
    ↓
[クリア] → リザルト画面
```

### 4.3 敵出現システム（ウェーブ制）

#### 基本設計
```
1ステージ = 雑魚100体 + ボス1体（計101体）
```

#### ウェーブ構成

| ウェーブ | 敵構成 | 出現条件 |
|----------|--------|----------|
| ウェーブ1 | 雑魚 20体 | ステージ開始時 |
| ウェーブ2 | 雑魚 25体 | 残り5体以下で発動 |
| ウェーブ3 | 雑魚 25体 + 中型 2体 | 残り5体以下で発動 |
| ウェーブ4 | 雑魚 30体 + 精鋭 1体 | 残り5体以下で発動 |
| ボスウェーブ | ボス1体（+ 雑魚が少しずつ湧く） | 100体撃破で発動 |

#### パフォーマンス設定

| 設定項目 | 値 |
|----------|---|
| 同時最大敵数 | 30〜40体 |
| オブジェクトプール上限 | 50体分（再利用） |
| スポーン間隔 | 0.3〜0.5秒 |

#### 撃破カウンター演出

```
【通常時】
画面上部: 「87 / 100」← 倒した数 / 目標

【100体撃破時】
画面演出: 「WARNING! BOSS APPROACHING!」
→ ボス登場カットイン
→ ボス戦開始
```

### 4.4 難易度

| 難易度 | 敵HP倍率 | 敵攻撃力 | 報酬倍率 | 解放条件 |
|--------|---------|---------|---------|---------|
| Easy | x1.0 | x1.0 | x1.0 | 最初から |
| Normal | x1.5 | x1.3 | x1.5 | Easy クリア |
| Hard | x2.0 | x1.8 | x2.0 | Normal クリア |
| Hell | x3.0 | x2.5 | x3.0 | Hard クリア |

---

## 5. キャラクターシステム

### 5.1 キャラクター要素

| 要素 | 説明 |
|------|------|
| **レアリティ** | N / R / SR / SSR / UR |
| **属性** | 火 / 水 / 雷 / 風 / 光 / 闇 |
| **タイプ** | 攻撃型 / 防御型 / バランス型 / スピード型 |
| **レベル** | 経験値で上昇、最大Lv100 |
| **覚醒** | 同キャラ素材で限界突破 |
| **スキル** | 固有スキル2つ + 無双奥義1つ |

### 5.2 ステータス

- HP（体力）
- ATK（攻撃力）
- DEF（防御力）
- SPD（移動速度・攻撃速度）
- CRI（クリティカル率）

### 5.3 キャラクター入手方法

1. ストーリー報酬（初期キャラ）
2. ガチャ
3. イベント報酬
4. ショップ購入（欠片交換）

---

## 6. 武器・装備システム

### 6.1 武器

| 要素 | 説明 |
|------|------|
| **種類** | 剣 / 槍 / 斧 / 弓 / 杖 など |
| **レアリティ** | N / R / SR / SSR / UR |
| **レベル** | 強化素材で上昇 |
| **オプション** | ランダム付与（攻撃力+○%等） |

### 6.2 装備（アクセサリー）

- 攻撃の指輪、防御のお守り等
- ステータス補正を付与
- セット効果あり（同シリーズ装備でボーナス）

---

## 7. UI設計

### 7.1 ホーム画面レイアウト

```
┌─────────────────────────────────────────┐
│  [通貨表示]  コイン: 10000  ジェム: 500  │
├─────────────────────────────────────────┤
│                                         │
│         【キャラクター3D表示】           │
│              (中央に大きく)              │
│                                         │
├─────────────────────────────────────────┤
│ [出撃]  [キャラ]  [武器]  [ガチャ]  [設定]│
└─────────────────────────────────────────┘
```

### 7.2 画面一覧

| 画面 | 機能 |
|------|------|
| **ホーム** | メイン画面、各機能へのアクセス |
| **出撃（ステージ選択）** | ワールド→ステージ→難易度選択 |
| **バトル画面** | 実際の戦闘 |
| **リザルト** | スコア、ドロップ、経験値表示 |
| **キャラクター** | 所持キャラ一覧、育成、編成 |
| **武器/装備** | 所持装備一覧、強化、装着 |
| **ガチャ** | キャラ/武器ガチャ |
| **ショップ** | 課金、アイテム購入 |
| **ミッション** | デイリー/ウィークリー/実績 |
| **設定** | BGM、SE、アカウント |

### 7.3 バトルUI

```
┌─────────────────────────────────────────┐
│ [HP]████████████  [無双ゲージ]██████    │
│ COMBO: 128        TIME: 02:45           │
├─────────────────────────────────────────┤
│                                         │
│              【バトルフィールド】        │
│                                         │
│                                         │
├─────────────────────────────────────────┤
│      [スキル1]  [スキル2]  [奥義]        │
│            [攻撃]  [回避]               │
└─────────────────────────────────────────┘
```

---

## 8. 課金システム

### 8.1 通貨設計

| 通貨 | 入手方法 | 用途 |
|------|---------|------|
| **コイン** | バトル報酬、ミッション | 強化、ショップ |
| **ジェム（有償）** | 課金のみ | ガチャ、スタミナ回復 |
| **ジェム（無償）** | ログボ、ミッション、初回報酬 | ガチャ、スタミナ回復 |

### 8.2 課金商品

| 商品 | 価格（案） | 内容 |
|------|-----------|------|
| ジェム60個 | 160円 | ジェム60個 |
| ジェム330個 | 800円 | ジェム330個 |
| ジェム700個 | 1,600円 | ジェム700個 |
| 月額パス | 500円 | 30日間毎日ジェム50個 |
| バトルパス | 1,000円 | シーズン報酬アンロック |
| 初心者パック | 300円 | SSRキャラ確定チケット+ジェム |

### 8.3 ガチャ設計

| レアリティ | 確率 |
|-----------|------|
| UR | 1% |
| SSR | 4% |
| SR | 15% |
| R | 40% |
| N | 40% |

- 10連ガチャ: SR以上1体確定
- 天井: 200連でURキャラ確定（選択可）
- ピックアップ: UR排出時50%で対象キャラ

### 8.4 スタミナ制（任意）

| 項目 | 値 |
|------|---|
| 最大スタミナ | 100 |
| 回復 | 5分で1回復 |
| ステージ消費 | 10〜20 |
| 回復アイテム | ジェム50個で全回復 |

※スタミナ制は無くして無制限プレイも選択肢

---

## 9. 継続プレイ要素

### 9.1 デイリーミッション
- ステージ3回クリア
- 敵を500体撃破
- コンボ100達成
- 報酬: コイン、ジェム（無償）

### 9.2 ウィークリーミッション
- ステージ20回クリア
- ボス10体撃破
- 報酬: ガチャチケット、強化素材

### 9.3 ログインボーナス
- 7日サイクル
- 7日目にガチャチケット or SR以上確定

### 9.4 バトルパス（シーズン）
- 無料枠と有料枠
- プレイでポイント獲得→報酬解放
- シーズン限定キャラ/武器

---

## 10. 実装優先度

### フェーズ1: MVP（最小限で遊べる状態）
1. ホーム画面（シンプル版）
2. 1ステージ分のバトル
3. 基本アクション（通常攻撃、スキル）
4. 敵AI（雑魚、ボス各1種）
5. リザルト画面

### フェーズ2: コアループ完成
1. ステージ選択画面
2. 複数ステージ（第1章分）
3. キャラクターレベルアップ
4. 武器システム
5. コンボシステム

### フェーズ3: 課金・継続要素
1. ガチャシステム
2. ショップ
3. デイリーミッション
4. ログインボーナス

### フェーズ4: 拡張
1. 追加ワールド
2. チャレンジモード
3. レイドボス
4. バトルパス

---

## 11. 技術的な検討事項

### 11.1 大量敵処理
- 画面内最大敵数: 50〜100体目標
- オブジェクトプール必須
- LOD（遠距離の敵は簡易表示）

### 11.2 ネットワーク
- 基本はソロプレイ（サーバー負荷軽減）
- データ保存はDataStore
- レイドはマッチング検討

### 11.3 不正対策
- ダメージ計算はサーバー側
- クリア判定もサーバー側
- 課金処理はRoblox公式API

---

## 12. 未決定事項（後で決める）

| 項目 | 選択肢 | 決定 |
|------|--------|------|
| 世界観・テーマ | 和風 / ファンタジー / 海賊 / オリジナル | 未定 |
| キャラデザインの方向性 | リアル系 / アニメ系 / デフォルメ | 未定 |
| マルチプレイ対応 | あり / なし / 後から追加 | 未定 |
| スタミナ制 | あり / なし | 未定 |
| 初期実装キャラ数 | 5体 / 10体 / 15体 | 未定 |
| ガチャ天井 | 100連 / 150連 / 200連 | 未定 |
| PvP要素 | あり / なし | 未定 |

---

## 13. 実装進捗

### 13.1 現在の実装状況

#### 完了した基盤システム
| システム | 場所 | 状態 |
|----------|------|------|
| GameManager | ReplicatedStorage/Modules | ✅ 完了 |
| EventManager | ReplicatedStorage/Modules | ✅ 完了 |
| DataManager | ReplicatedStorage/Modules | ✅ 完了（DataStore未公開のためエラー） |
| UIManager | ReplicatedStorage/Modules | ✅ 完了 |
| GameService | ServerScriptService/Services | ✅ 完了 |
| GameController | StarterPlayerScripts/Controllers | ✅ 完了 |

#### バトルシステム実装状況
| 機能 | 状態 | 備考 |
|------|------|------|
| テストフィールド（200x200） | ✅ 完了 | BattleField |
| 敵テンプレート | ✅ 完了 | Assets/EnemyTemplate |
| 敵スポーン処理 | ⚠️ 問題あり | ログは出るが敵が表示されない |
| 敵AI（追跡） | ✅ 完了 | プレイヤーに向かって移動 |
| 攻撃処理（サーバー側） | ✅ 完了 | AttackService |
| クリック入力 | ✅ 完了 | BattleController |
| ダメージ判定 | ✅ 完了 | 前方6m、70度の範囲 |

#### 未実装機能
| 機能 | 優先度 |
|------|--------|
| 敵スポーン表示の修正 | 高 |
| 攻撃アニメーション | 中 |
| ヒットエフェクト | 中 |
| ダメージ表示（数字） | 中 |
| ノックバック | 低 |
| コンボカウンター | 中 |
| 無双ゲージ・奥義 | 中 |
| スキル1, 2 | 中 |

### 13.2 既知の問題

| 問題 | 状況 |
|------|------|
| 敵がスポーンしても表示されない | スポーンログは出るが画面に出ない。Templateの表示設定を要調査 |
| DataStoreエラー | Placeを公開していないため。動作には影響なし |

### 13.3 フォルダ構成

```
Workspace/
  ├ BattleField          -- 200x200の草原
  ├ SpawnLocation        -- プレイヤー出現地点
  ├ Assets/
  │   └ EnemyTemplate    -- 敵のテンプレート
  └ Enemies/             -- アクティブな敵

ReplicatedStorage/
  ├ Modules/
  │   ├ GameManager
  │   ├ EventManager
  │   ├ DataManager
  │   ├ UIManager
  │   ├ Battle/
  │   │   └ CombatSystem
  │   ├ Enemy/
  │   │   ├ EnemyPool
  │   │   ├ EnemyManager
  │   │   └ EnemyAI
  │   └ Player/
  │       └ PlayerCombat
  ├ Events/
  │   └ PlayerAttack     -- 攻撃用RemoteEvent
  ├ Assets/
  └ Configs/

ServerScriptService/
  └ Services/
      ├ GameService
      ├ AttackService    -- 攻撃ダメージ処理
      └ EnemySpawnService -- 敵スポーン+AI

StarterPlayerScripts/
  └ Controllers/
      ├ GameController
      └ BattleController -- クリック入力処理
```
