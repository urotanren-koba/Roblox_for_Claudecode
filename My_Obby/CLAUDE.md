# RPG風Obby - 開発計画書

## プロジェクト概要

Obby（障害物コース）にRPG要素（収集・戦闘・ボス）を融合したRobloxゲーム。
「倒したい」欲求を満たしつつ、テンポよく周回できるゲーム体験を提供する。

## ゲームコンセプト

1. ステージを進みながら**コイン/アイテム**を収集
2. 途中の**戦闘部屋**で雑魚を倒して**ステージポイント**獲得
3. ゴールの**ボス戦**でステージポイントを消費して有利に戦闘
4. Obbyの上手さが戦闘・ボス攻略に繋がる設計

---

## フェーズ別開発計画

### Phase 1: 基盤システム（Obby + チェックポイント）
- [x] 基本的なプラットフォーム配置
- [x] チェックポイントシステム
- [x] 落下検知・リスポーン
- [ ] ステージ構造のフォルダ整理（Stage1, Stage2...）

### Phase 2: 収集システム
- [x] コイン配置・取得処理
- [x] コインUIの実装（画面左上に表示）
- [x] アイテム配置（回復薬、強化弾、シールド）
- [x] アイテムUIスロット（画面下部）

### Phase 3: プレイヤー戦闘システム
- [x] 魔法弾攻撃（クリック/タップで発射）
- [x] 回避アクション（クールダウン付き）
- [x] プレイヤーHPシステム
- [x] ダメージ判定（サーバー側処理）

### Phase 4: 戦闘部屋システム
- [x] 戦闘部屋のエリア作成
- [x] 雑魚敵AI（突進型）
- [x] 雑魚敵AI（弾撃ち型）
- [x] Wave出現システム
- [x] ステージポイント獲得処理

### Phase 5: ボス戦システム
- [x] ボス部屋の作成
- [x] ボスAI（攻撃パターン3種）
- [x] ボスHPゲージUI
- [x] ステージポイント消費システム
  - [x] 回復アイテム使用
  - [x] 強弾発射
  - [x] シールド展開
- [x] ボス撃破・クリア判定

### Phase 6: UI/UX完成
- [x] コイン表示UI
- [x] ステージポイント表示UI
- [x] プレイヤーHP表示
- [x] ボスHP表示
- [x] アイテムスロットUI
- [x] クリア画面

### Phase 7: 調整・ポリッシュ
- [ ] ゲームバランス調整
- [ ] パフォーマンス最適化
- [ ] モバイル対応確認
- [ ] サウンド追加

---

## 技術設計方針

### フォルダ構成
```
Workspace/
├── Stages/
│   └── Stage1/
│       ├── Platforms/
│       ├── Checkpoints/
│       ├── Coins/
│       ├── Items/
│       ├── BattleRooms/
│       └── BossRoom/
├── Enemies/ (テンプレート用)
└── Effects/

ServerScriptService/
├── GameManager.lua
├── CombatSystem.lua
├── CheckpointSystem.lua
└── BossManager.lua

ReplicatedStorage/
├── Remotes/
├── Modules/
└── Assets/

StarterGui/
├── CoinUI
├── StagePointUI
├── PlayerHPUI
├── BossHPUI
└── ItemSlotUI
```

### 重要ルール
1. **サーバー権威**: HP、ポイント、クリア判定はサーバーで確定
2. **イベント駆動**: RunService多用禁止、Touched/RemoteEventで処理
3. **軽量化**: 雑魚は戦闘部屋のみ、同時最大6体
4. **テンポ重視**: 戦闘部屋は10-25秒で解決

### RemoteEvent設計
```
Remotes/
├── Attack (Client→Server: 攻撃リクエスト)
├── UseItem (Client→Server: アイテム使用)
├── UpdateUI (Server→Client: UI更新)
├── SpawnEnemy (Server→Client: 敵出現通知)
└── BossEvent (Server→Client: ボス状態同期)
```

---

## MVP完成条件

1. Obby: チェックポイント・リスポーン・ゴールが安定動作
2. 収集: コインが取得でき、UIに反映される
3. 戦闘: 雑魚が出現し、倒せて、ポイントが増える
4. ボス: ボスHPが減り、撃破でクリアできる
5. ポイント消費: ボス戦で回復/強弾/シールドが機能

---

## 現在の進捗

**最終更新**: 2026-01-12

### Phase 1: Stage1「古代遺跡」完成
- [x] スタートエリア（神殿の入口 + 柱の装飾）
- [x] 序盤Obby（階段状の足場5段）
- [x] 崩れた橋エリア（不規則な足場配置）
- [x] 壁ジャンプエリア（左右交互の足場6段）
- [x] 戦闘部屋（50x50のアリーナ + 壁 + ゲート）
- [x] 後半Obby（浮遊する石 + 危険地帯）
- [x] ボス部屋（円形アリーナ + 8本の柱 + 玉座）

### ギミック実装済み
- [x] 消えるブロック（3個、タイミングずらし）
- [x] 動くプラットフォーム（左右移動）
- [x] 回転する障害物（ボス部屋前）
- [x] トランポリン（高くジャンプ）

### システム実装済み
- [x] チェックポイント4箇所（各エリア）
- [x] キルゾーン（落下検知）
- [x] チェックポイント保存システム
- [x] 松明の装飾（6箇所）

### Phase 2: 収集システム完成
- [x] コイン配置（36枚）- 金色、回転アニメーション
- [x] コイン取得処理 + UI（画面左上）
- [x] アイテム配置（10個）
  - 回復薬(緑): 4個
  - 強化弾(青): 3個
  - シールド(紫): 3個
- [x] アイテム取得処理 + UI（画面下部スロット）

### Phase 3-6: 戦闘システム完成
- [x] プレイヤー戦闘（魔法弾攻撃、回避、HP）
- [x] 雑魚敵AI（突進型 + 弾撃ち型）
- [x] 戦闘部屋Waveシステム（2Wave）
- [x] ボス「Ancient Guardian」
  - 攻撃パターン1: 全方位弾
  - 攻撃パターン2: 追尾弾
  - 攻撃パターン3: 地面衝撃波
- [x] 全UI実装（HP、SP、ボスHP、クリア画面）

### 次のタスク
→ **Phase 7: 調整・ポリッシュ**（バランス調整、サウンド）

---

## 参考パラメータ

| 項目 | 初期値 |
|------|--------|
| 戦闘部屋解決時間 | 10-25秒 |
| 同時雑魚数 | 3-4体（最大6） |
| アイテム種類 | 3種類 |
| プレイヤーHP | 100 |
| 雑魚HP | 20-30 |
| ボスHP | 300 |
| 魔法弾ダメージ | 10 |
| 強弾ダメージ | 25 |
