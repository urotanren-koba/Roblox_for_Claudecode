以下に、ここまでの内容を前提にした **「RPG風Obby」要件定義書（ドラフト）** をまとめます。
※Robloxで実装しやすい粒度に寄せています（後からそのまま機能要件・タスク分解に落とせる形です）。

---

# 要件定義書：RPG風Obby（Roblox）

## 1. 目的・狙い

* Obby（移動・ジャンプ）にRPG要素（収集・戦闘・ボス）を融合し、**中盤以降の飽き**を抑えて最後まで遊ばれるゲームを作る。
* 「倒したい」欲求を満たしつつ、**テンポよく周回**できるゲーム体験を提供する。

---

## 2. コンセプト概要

* プレイヤーはステージを進みながら **コイン／アイテム** を収集する。
* 途中に **戦闘部屋（雑魚戦）** があり、雑魚を倒して **ステージポイント** を獲得する。
* ステージゴールには **ボス** が待機し、集めたステージポイントを使うことで攻略が有利になる（回復・強弾・シールド等）。
* Obbyの上手さ（進行速度、ルート選択）が、戦闘・ボス攻略に繋がる設計を目指す。

---

## 3. 対象プラットフォーム・前提

* プラットフォーム：Roblox（PC / Mobile / Console想定）
* 同時参加：未確定（設計上は軽量優先、将来の増員を想定）
* オンラインマルチ：同一サーバー内で同時プレイ（協力・競争要素は拡張余地）

---

## 4. 用語定義

* **ステージポイント**：当該ステージ内で獲得し、ボス戦で消費する“戦闘資源”（ステージ外へ原則持ち越さない）
* **戦闘部屋**：Obby中に挟まる短時間の雑魚戦エリア（10〜25秒程度で解決を狙う）
* **コイン**：探索・ルート選択の報酬（用途はアイテム獲得、もしくはステージポイント補助など、設計で調整）

---

## 5. ゲームループ（基本フロー）

1. ロビー（任意：スタート、説明、装備/見た目、ランキング）
2. ステージ開始（Obby区間）
3. コイン／アイテム収集（ルート分岐・隠し要素あり）
4. 戦闘部屋（雑魚を倒してステージポイント獲得）
5. Obby区間（続き）
6. ボス部屋到達（ボス戦）
7. クリア報酬 → 次ステージへ（または周回）

---

## 6. コア設計方針（重要ルール）

### 6.1 飽き防止（テンポ）

* 雑魚戦は長引かせない（目標：**10〜25秒**）
* 戦闘操作は複雑にしない（目標：**攻撃＋回避（orガード）**）

### 6.2 収集の必須度

* ボス攻略に必要な最低ラインは「普通に進めば届く」難度にする
  → 探索は“必須”ではなく、“有利になる選択”とする。

### 6.3 軽量化優先

* 雑魚は「戦闘部屋のみ」「同時出現数を制限」して負荷を抑える。
* 無駄な常時監視（毎フレーム処理）を避け、イベント駆動を基本とする。

---

# 7. 機能要件（Functional Requirements）

## 7.1 Obby（ステージ進行）

* ステージは複数の区間で構成される。
* 落下／危険判定によりリスポーン（チェックポイント復帰）する。
* チェックポイント：

  * 接触で更新
  * サーバー側でプレイヤーの復帰地点を保持

## 7.2 収集（コイン・アイテム）

* コイン：

  * 取得でカウント増加（UI表示）
  * 取得済みは再出現しない（同一セッション内）
* アイテム：

  * ステージ内に配置（ルート分岐や隠し要素に配置）
  * 使用タイミング：原則「ボス戦」または「戦闘部屋」で利用可能
  * 最初は種類を絞る（例：3種）

## 7.3 戦闘部屋（雑魚戦）

* 戦闘部屋に入ると雑魚が出現（Wave形式でも可）
* 雑魚を倒すとステージポイントが増加
* 雑魚の種類（MVP想定）：

  * 突進型（近接）
  * 弾撃ち型（遠隔）
* 同時出現数は上限を設ける（初期：最大6、推奨は3〜4）

## 7.4 プレイヤー戦闘（倒したい前提）

* 攻撃手段：未確定（推奨は遠距離“魔法弾”から開始）
* 回避/ガード：

  * クールダウンあり
  * 短時間無敵またはダメ軽減
* ダメージ判定はサーバー確定（チート耐性のため）

## 7.5 ステージポイント（ボス戦資源）

* 戦闘部屋で獲得するステージ内限定のリソース
* ボス戦で以下に変換（例）：

  * 回復回数
  * 強弾/スキル弾数
  * シールド（被弾無効1回）
* 変換レートはゲームバランス調整対象

## 7.6 ボス戦

* ステージゴールにボス部屋が存在
* ボスは複雑な殴り合いではなく、短時間で攻略の手応えが出る構造を優先
* ステージポイントを使うことで、攻略が安定/高速化する
* ボスHP、状態はサーバーで管理し、全クライアントに同期

## 7.7 UI（最低限）

* コイン数表示
* ステージポイント表示
* プレイヤーHP（必要なら）
* ボスHPゲージ
* アイテムスロット表示（所持・使用可能回数）

## 7.8 クリア・進行

* ステージクリア判定
* 次ステージ解放（MVPでは1ステージでも可）
* リトライ（同ステージ再挑戦）

## 7.9 データ保存（任意：フェーズ2以降）

* 保存候補：

  * クリア状況
  * 恒久アイテム/見た目
  * 通算コインなど
* ステージポイントは原則保存しない（当該プレイ限り）

---

# 8. 非機能要件（Non-Functional Requirements）

## 8.1 パフォーマンス

* 雑魚AIは軽量にする（経路探索・群れ行動は初期スコープ外）
* 常時実行ループを避ける（RunService多用禁止、イベント駆動中心）
* パーティクル・ライトは控えめ（モバイルでの動作を優先）
* 動くギミックはTween中心、物理依存を減らす

## 8.2 ネットワーク・同期

* 重要状態（HP、ポイント、クリア判定）はサーバーで確定
* クライアントは演出中心（見た目の反応はローカルで高速に）
* 不要な状態同期を避ける（頻繁な位置同期や大量イベント送信を抑制）

## 8.3 セキュリティ（最低限）

* クライアント申告の「ヒット」「取得」を信用しない
* 異常値（瞬間移動、極端速度など）の簡易検知は将来拡張

## 8.4 運用・拡張性

* ステージは部品化し、追加しやすい構造を想定
* 敵種類、アイテム種類は増やせる前提（初期は少数精鋭）

---

# 9. スコープ（範囲）

## 9.1 MVP（最初に作る最小構成）

* 1ステージ（Obby区間＋戦闘部屋＋ボス）
* コイン収集（カウント表示）
* 戦闘部屋：雑魚2種類、同時3〜4体
* ステージポイント → ボス戦で回復/強弾/シールドに変換
* UI：コイン、ポイント、ボスHP

## 9.2 将来拡張（フェーズ2以降）

* ステージ追加（テーマ別）
* デイリー/週替わり要素
* ランキング（タイム/スコア）
* 恒久成長（装備・レベル・称号）
* 協力/競争要素の強化

## 9.3 初期スコープ外（当面やらない）

* 大規模な経路探索AI（高度なCPU）
* 大量同時NPCの常時配置
* 複雑な装備ビルド（スキルツリー等）
* PvP（プレイヤー同士の戦闘）

---

# 10. 主要パラメータ（初期たたき台）

* 戦闘部屋の解決時間：10〜25秒
* 同時雑魚数：最大6（推奨3〜4）
* アイテム種類：3種類から開始
* ステージポイント用途：回復/強弾/シールド（いずれも回数制）

---

# 11. 受け入れ条件（完成判定の目安）

* Obby：チェックポイント・リスポーン・ゴールが安定動作する
* 収集：コインが取得でき、UIに反映される
* 戦闘：雑魚が出現し、倒せて、ポイントが増える
* ボス：ボスHPが減り、撃破でクリアできる
* ポイント消費：ボス戦で回復/強弾/シールドが機能し、攻略が有利になる
* モバイル想定でも極端なカクつきが出ない（NPCを戦闘部屋限定で運用）

---

必要なら次に、これをベースに **機能要件をさらに分解（画面別・サーバー/クライアント別・RemoteEvent設計）** して、実装タスクに落とした「開発仕様書」まで作れます。
その前に1点だけ確認させてください。**攻撃手段は最初、遠距離（魔法弾）で進める方針で問題ございませんか？**（剣は後から追加でも成立します）
